<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="tipmap">
<title>Introduction to the 'tipmap' package â€¢ tipmap</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to the 'tipmap' package">
<meta property="og:description" content="tipmap">
<meta property="og:image" content="https://boehringer-ingelheim.github.io/tipmap/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">tipmap</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/expert_elicitation.html">Specifying a primary weight of the informative prior component</a>
    <a class="dropdown-item" href="../articles/introduction.html">Introduction to the 'tipmap' package</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/Boehringer-Ingelheim/tipmap/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Introduction to the 'tipmap' package</h1>
            <h3 data-toc-skip class="subtitle">Tipping point analysis
for clinical trials that employ Bayesian dynamic borrowing</h3>
                        <h4 data-toc-skip class="author">Christian
Stock</h4>
            
            <h4 data-toc-skip class="date">2024-04-04</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/Boehringer-Ingelheim/tipmap/blob/HEAD/vignettes/introduction.Rmd" class="external-link"><code>vignettes/introduction.Rmd</code></a></small>
      <div class="d-none name"><code>introduction.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="purpose-of-the-package">Purpose of the package<a class="anchor" aria-label="anchor" href="#purpose-of-the-package"></a>
</h2>
<p>The R package <strong>tipmap</strong> implements a tipping point
analysis for clinical trials that employ Bayesian dynamic borrowing of a
treatment effect from external evidence via robust meta-analytic
predictive (MAP) priors. A tipping point analysis allows to assess how
much weight on the informative component of a robust MAP prior is needed
to conclude that the investigated treatment is efficacious, based on the
total evidence. The package mainly provides an implementation of a
graphical approach proposed by <span class="citation">Best <em>et
al.</em> (2021)</span> for different one-sided evidence levels (80%,
90%, 95%, 97.5%).</p>
<p>Tipping point analyses can be useful both at the planning and the
analysis stage of a clinical trial that uses external information. At
the <em>planning stage</em>, they can help to determe (pre-specify) a
weight of the informative component of the MAP prior for a primary
analysis. Various possible results of the planned trial in the target
population and implications for the treatment effect estimate and
statistical inferences based on the total evidence may be explored for a
range of weights. Through this exercise, in addition to other criteria,
decision-makers can develop a sense under which circumstances they would
still feel comfortable to establish efficacy with a specific level of
certainty. A preferred primary weight will typically be a compromise
between the belief in the applicability of the data and operating
characteristics of the resulting design specifications. At the
<em>analysis stage</em>, tipping point analyses can be used as a
sensitivity analysis to assess the dependency of the treatment effect
estimate and statistical inferences on the weight of the informative
component of the MAP prior. This can also be understood in the sense of
a reverse-Bayes analysis (<span class="citation">Held <em>et al.</em>
(2022)</span>).</p>
<p>This vignette shows an exemplary application of the tipping point
analysis with hypothetical data.</p>
<p>Further functions in this package (not illustrated in this vignette)
facilitate the specification of a robust MAP prior via expert
elicitation, specifically the choice of a primary weight (using the
roulette method).</p>
<p>Intended use of the <strong>tipmap</strong>-package is the planning,
analysis and interpretation of (small) clinical trials in pediatric drug
development, where extrapolation of efficacy, often through Bayesian
methods, has become increasingly common (<span class="citation">Gamalo
<em>et al.</em> (2022)</span>; <span class="citation">ICH (2022)</span>;
<span class="citation">Ionan <em>et al.</em> (2023)</span>; <span class="citation">Travis <em>et al.</em> (2023)</span>). For an
application, see <span class="citation">Maher <em>et al.</em>
(2024)</span>.</p>
<p>For the implementation of the MAP prior approach, including
computation of the posterior distribution, the
<strong>RBesT</strong>-package is used (<span class="citation">Weber
<em>et al.</em> (2021)</span>).</p>
</div>
<div class="section level2">
<h2 id="generating-data-for-an-exemplary-tipping-point-analysis">Generating data for an exemplary tipping point analysis<a class="anchor" aria-label="anchor" href="#generating-data-for-an-exemplary-tipping-point-analysis"></a>
</h2>
<p>In this vignette, we assume that results from three clinical trials
conducted in adult patients (the <em>source</em> population) are
available, which share key features with a new trial among pediatric
patients (the <em>target</em> population). For example, they had been
conducted in the same indication, studied the same drug and provided
results on an endpoint of interest for the target population. This means
a certain degree of <em>exchangeability</em> between the trials in the
source and target population can be assumed. The similarity in disease
and response to treatment between source and target population always
need to be carefully considered in any setting, usually by clinical
experts in the disease area.</p>
<p>We assume that it is supported by medical evidence and now planned to
consider the trials in adult patients in a Bayesian dynamic borrowing
approach, and we would like to create a robust MAP prior (<span class="citation">Schmidli <em>et al.</em> (2014)</span>). The treatment
effect measure of interest is assumed to be a mean difference between a
treated group and a control group with respect to a continuous
endpoint.</p>
<div class="section level3">
<h3 id="derivation-of-map-prior-based-on-trials-in-the-source-population">Derivation of MAP prior based on trials in the source
population<a class="anchor" aria-label="anchor" href="#derivation-of-map-prior-based-on-trials-in-the-source-population"></a>
</h3>
<p>We start by specifying an object that contains the prior data.</p>
<p>The function <code><a href="../reference/create_prior_data.html">create_prior_data()</a></code> takes vectors of total
sample sizes, treatment effect estimates and their standard errors as
arguments and generates a data frame. A study label is optional.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">library</span>(tipmap)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="sc">&gt;</span> prior_data <span class="ot">&lt;-</span> <span class="fu">create_prior_data</span>(</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="sc">+</span>   <span class="at">n_total =</span> <span class="fu">c</span>(<span class="dv">160</span>, <span class="dv">240</span>, <span class="dv">320</span>),</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="sc">+</span>   <span class="at">est =</span> <span class="fu">c</span>(<span class="fl">1.16</span>, <span class="fl">1.43</span>, <span class="fl">1.59</span>),</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="sc">+</span>   <span class="at">se =</span> <span class="fu">c</span>(<span class="fl">0.46</span>, <span class="fl">0.35</span>, <span class="fl">0.28</span>)</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="sc">+</span> )</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">print</span>(prior_data)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="co">#   study_label n_total  est   se</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="co"># 1     Study 1     160 1.16 0.46</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="co"># 2     Study 2     240 1.43 0.35</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="co"># 3     Study 3     320 1.59 0.28</span></span></code></pre></div>
<p>We then generate a MAP prior from our prior data using the
<strong>RBesT</strong>-package (<span class="citation">Weber <em>et
al.</em> (2021)</span>).</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="sc">&gt;</span> uisd <span class="ot">&lt;-</span> <span class="fl">5.42</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="sc">&gt;</span> map_mcmc <span class="ot">&lt;-</span> RBesT<span class="sc">::</span><span class="fu">gMAP</span>(</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="sc">+</span>   <span class="at">formula =</span> <span class="fu">cbind</span>(est, se) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> study_label,</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="sc">+</span>   <span class="at">data =</span> prior_data,</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="sc">+</span>   <span class="at">family =</span> gaussian,</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="sc">+</span>   <span class="at">weights =</span> n_total,</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="sc">+</span>   <span class="at">tau.dist =</span> <span class="st">"HalfNormal"</span>,</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="sc">+</span>   <span class="at">tau.prior =</span> <span class="fu">cbind</span>(<span class="dv">0</span>, uisd <span class="sc">/</span> <span class="dv">16</span>),</span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="sc">+</span>   <span class="at">beta.prior =</span> <span class="fu">cbind</span>(<span class="dv">0</span>, uisd)</span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="sc">+</span>   )</span></code></pre></div>
<p>A few additional specifications are needed to be made to fit the MAP
prior model; for details see <span class="citation">Neuenschwander and
Schmidli (2020)</span> or <span class="citation">Weber <em>et al.</em>
(2021)</span>. The variable <code>uisd</code> here represents an assumed
unit-information standard deviation and the specification of the prior
on between-trial heterogeneity parameter tau follows recommendations to
consider moderate heterogeneity for a two-group parameter, such as the
mean difference (<span class="citation">Neuenschwander and Schmidli
(2020)</span>).</p>
<p>This is a summary of the fitted model based on samples from the
posterior distribution:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">summary</span>(map_mcmc)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="co"># Heterogeneity parameter tau per stratum:</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="co">#         mean    sd    2.5%   50% 97.5%</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co"># tau[1] 0.205 0.162 0.00761 0.168 0.603</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co"># Regression coefficients:</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="co">#             mean   sd  2.5%  50% 97.5%</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co"># (Intercept) 1.43 0.25 0.922 1.44  1.92</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="co"># Mean estimate MCMC sample:</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="co">#            mean   sd  2.5%  50% 97.5%</span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="co"># theta_resp 1.43 0.25 0.922 1.44  1.92</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="co"># MAP Prior MCMC sample:</span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a><span class="co">#                 mean    sd  2.5%  50% 97.5%</span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a><span class="co"># theta_resp_pred 1.43 0.356 0.661 1.44   2.1</span></span></code></pre></div>
<p>A forest plot of the Bayesian meta-analysis is shown in Figure 1. It
is augmented with meta-analytic shrinkage estimates per trial. The
figure shows the per-trial point estimates (light point) and the 95%
frequentist confidence intervals (dashed line) and the model derived
median (dark point) and the 95% credible interval of the meta-analytic
model.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">plot</span>(map_mcmc)<span class="sc">$</span>forest_model</span></code></pre></div>
<div class="figure">
<img src="introduction_files/figure-html/forest_plot-1.png" alt="Figure 1: Forest plot." width="70%"><p class="caption">
Figure 1: Forest plot.
</p>
</div>
<p>Subsequently, the MAP prior is approximated by a mixture of conjugate
normal distributions. The parametric form facilitates the computation of
posteriors when the MAP prior is combined with results from the trial in
the target population.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="sc">&gt;</span> map_prior <span class="ot">&lt;-</span> RBesT<span class="sc">::</span><span class="fu">automixfit</span>(</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="sc">+</span>   <span class="at">sample =</span> map_mcmc,</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="sc">+</span>   <span class="at">Nc =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">4</span>),</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="sc">+</span>   <span class="at">k =</span> <span class="dv">6</span>,</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="sc">+</span>   <span class="at">thresh =</span> <span class="sc">-</span><span class="cn">Inf</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="sc">+</span>   )</span></code></pre></div>
<p>The approximation yields a mixture of two normals:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">print</span>(map_prior)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="co"># EM for Normal Mixture Model</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="co"># Log-Likelihood = -1335.201</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="co"># Univariate normal mixture</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co"># Reference scale: 5.298722</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="co"># Mixture Components:</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="co">#   comp1     comp2    </span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="co"># w 0.7717324 0.2282676</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a><span class="co"># m 1.4522222 1.3625788</span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="co"># s 0.2508704 0.5793548</span></span></code></pre></div>
<p>The density of the parametric mixture together with a histogram of
MCMC samples from the <code>map_mcmc</code> object is shown in Figure
2.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">plot</span>(map_prior)<span class="sc">$</span>mix</span></code></pre></div>
<div class="figure">
<img src="introduction_files/figure-html/map_prior_dens-1.png" alt="Figure 2: Overlay of the MCMC histogram of the MAP prior and the fitted parametric mixture approximation." width="70%"><p class="caption">
Figure 2: Overlay of the MCMC histogram of the MAP prior and the fitted
parametric mixture approximation.
</p>
</div>
<p>The derivation of the MAP prior is now complete. For normal
likelihoods the parametric representation by a mixture of normals can be
used to calculate posterior distributions analytically.</p>
</div>
<div class="section level3">
<h3 id="trial-results-in-the-target-population">Trial results in the target population<a class="anchor" aria-label="anchor" href="#trial-results-in-the-target-population"></a>
</h3>
<p>We now create a numeric vector with data on pediatric trial (the
total sample size, the treatment effect estimate and its standard
error). In the planning stage, this may be an expected result.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="sc">&gt;</span> pediatric_trial <span class="ot">&lt;-</span> <span class="fu">create_new_trial_data</span>(<span class="at">n_total =</span> <span class="dv">30</span>, <span class="at">est =</span> <span class="fl">1.02</span>, <span class="at">se =</span> <span class="fl">1.4</span>)</span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">print</span>(pediatric_trial)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="co">#     n_total        mean          se       q0.01      q0.025       q0.05 </span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="co"># 30.00000000  1.02000000  1.40000000 -2.23688702 -1.72394958 -1.28279508 </span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="co">#        q0.1        q0.2       q0.25        q0.5       q0.75        q0.8 </span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a><span class="co"># -0.77417219 -0.15826973  0.07571435  1.02000000  1.96428565  2.19826973 </span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a><span class="co">#        q0.9       q0.95      q0.975       q0.99 </span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a><span class="co">#  2.81417219  3.32279508  3.76394958  4.27688702</span></span></code></pre></div>
<p>The function <code><a href="../reference/create_new_trial_data.html">create_new_trial_data()</a></code> computes quantiles,
assuming normally distributed errors. This is merely used to plot a
confidence interval for the treatment effect estimate obtained in the
target trial in the tipping point plot.</p>
</div>
</div>
<div class="section level2">
<h2 id="performing-the-tipping-point-analysis">Performing the tipping point analysis<a class="anchor" aria-label="anchor" href="#performing-the-tipping-point-analysis"></a>
</h2>
<div class="section level3">
<h3 id="computation-of-posteriors-for-a-range-of-weights">Computation of posteriors for a range of weights<a class="anchor" aria-label="anchor" href="#computation-of-posteriors-for-a-range-of-weights"></a>
</h3>
<p>We can now compute posterior distributions for a range of weights
using the function <code><a href="../reference/create_posterior_data.html">create_posterior_data()</a></code>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="sc">&gt;</span> posterior <span class="ot">&lt;-</span> <span class="fu">create_posterior_data</span>(</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="sc">+</span>   <span class="at">map_prior =</span> map_prior,</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="sc">+</span>   <span class="at">new_trial_data =</span> pediatric_trial,</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="sc">+</span>   <span class="at">sigma =</span> uisd)</span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">head</span>(posterior, <span class="dv">4</span>)</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="co">#         weight     q0.01    q0.025     q0.05       q0.1       q0.2      q0.25</span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="co"># w=0      0.000 -2.197193 -1.700552 -1.273414 -0.7809595 -0.1846242 0.04189379</span></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="co"># w=0.005  0.005 -2.187599 -1.689612 -1.261009 -0.7663718 -0.1663690 0.06195571</span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="co"># w=0.01   0.010 -2.178066 -1.678733 -1.248665 -0.7518369 -0.1481464 0.08192592</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="co"># w=0.015  0.015 -2.168591 -1.667913 -1.236379 -0.7373439 -0.1299534 0.10185010</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="co">#              q0.5    q0.75     q0.8     q0.9    q0.95   q0.975    q0.99</span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="co"># w=0     0.9562020 1.870510 2.097028 2.693363 3.185818 3.612956 4.109597</span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a><span class="co"># w=0.005 0.9830598 1.855910 2.080570 2.678945 3.173427 3.602017 4.100003</span></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a><span class="co"># w=0.01  1.0088455 1.842214 2.064425 2.664604 3.161099 3.591139 4.090470</span></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a><span class="co"># w=0.015 1.0334528 1.829396 2.048622 2.650338 3.148831 3.580320 4.080995</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">tail</span>(posterior, <span class="dv">4</span>)</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="co">#         weight     q0.01    q0.025     q0.05     q0.1     q0.2    q0.25</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a><span class="co"># w=0.985  0.985 0.3713404 0.6388480 0.8437628 1.017064 1.174189 1.226884</span></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="co"># w=0.99   0.990 0.3832902 0.6451026 0.8468235 1.018361 1.174756 1.227315</span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="co"># w=0.995  0.995 0.3949008 0.6512286 0.8498686 1.019639 1.175316 1.227742</span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a><span class="co"># w=1      1.000 0.4061874 0.6572285 0.8528261 1.020899 1.175870 1.228164</span></span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a><span class="co">#             q0.5    q0.75     q0.8     q0.9    q0.95   q0.975    q0.99</span></span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a><span class="co"># w=0.985 1.423876 1.613789 1.661732 1.793835 1.916689 2.046120 2.246768</span></span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a><span class="co"># w=0.99  1.424005 1.613712 1.661591 1.793427 1.915776 2.044136 2.241692</span></span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a><span class="co"># w=0.995 1.424132 1.613636 1.661451 1.793023 1.914875 2.042187 2.236725</span></span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a><span class="co"># w=1     1.424259 1.613560 1.661313 1.792624 1.913986 2.040272 2.231867</span></span></code></pre></div>
<p>The resulting data frame has 201 rows and 14 columns. The weights
increase incrementally in steps of 0.005 from 0 to 1, i.e.Â posterior
quantiles for 201 weights are computed. For each weight the data frame
contains the following 13 posterior quantiles.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">colnames</span>(posterior)[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="co">#  [1] "q0.01"  "q0.025" "q0.05"  "q0.1"   "q0.2"   "q0.25"  "q0.5"   "q0.75" </span></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="co">#  [9] "q0.8"   "q0.9"   "q0.95"  "q0.975" "q0.99"</span></span></code></pre></div>
<p>These posterior quantiles can be directly used for inferences based
on the total evidence (new data and prior combined). They reflect
one-sided 99%, 97.5%, 95%, 90%, 80%, and 50% evidence levels for a given
weight, respectively.</p>
</div>
<div class="section level3">
<h3 id="creating-the-tipping-point-plot">Creating the tipping point plot<a class="anchor" aria-label="anchor" href="#creating-the-tipping-point-plot"></a>
</h3>
<p>The function to produce the tipping point plot is called
<code><a href="../reference/tipmap_plot.html">tipmap_plot()</a></code>, it requires a dataframe with data on all
components generated by the function
<code><a href="../reference/create_tipmap_data.html">create_tipmap_data()</a></code>.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="sc">&gt;</span> tipmap_data <span class="ot">&lt;-</span> <span class="fu">create_tipmap_data</span>(</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="sc">+</span>   <span class="at">new_trial_data =</span> pediatric_trial,</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a><span class="sc">+</span>   <span class="at">posterior =</span> posterior,</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a><span class="sc">+</span>   <span class="at">map_prior =</span> map_prior)</span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="sc">&gt;</span> (p1 <span class="ot">&lt;-</span> <span class="fu">tipmap_plot</span>(<span class="at">tipmap_data =</span> tipmap_data))</span></code></pre></div>
<div class="figure">
<img src="introduction_files/figure-html/tipmap_plot-1.png" alt="Figure 3: Tipping point plot." width="95%"><p class="caption">
Figure 3: Tipping point plot.
</p>
</div>
<p>At the center of the plot, quantiles of the posterior distribution
are shown, defining credible intervals of the effect estimate and also
one-sided evidence-levels for given weights of the informative component
of the MAP prior. The intersections between the lines connecting the
respective quantiles and the horizontal line at 0 (the null effect) are
referred to as tipping points (indicated by vertical lines in red
color). They indictae the minimum weight that is required to conclude
that the treatment is efficacious for a given one-sided evidence level
(<span class="citation">Best <em>et al.</em> (2021)</span>). On the left
and right side of the plot, the treatment effect estimate obtained in
the trial in the (pediatric) target population (with 95% confidence
interval) and the MAP prior (with 95% credible interval) are shown,
respectively.</p>
<p>The plot is a <code>ggplot</code>-object that can be modified
accordingly. For example, if we had chosen a primary weight of 0.38, we
could add a vertical reference line at this position. There are
additional features to customize the plot in the
<code><a href="../reference/tipmap_plot.html">tipmap_plot()</a></code> function, see
<code><a href="../reference/tipmap_plot.html">help(tipmap_plot)</a></code>.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="sc">&gt;</span> primary_weight <span class="ot">&lt;-</span> <span class="fl">0.38</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="sc">&gt;</span> (p2 <span class="ot">&lt;-</span> p1 <span class="sc">+</span> ggplot2<span class="sc">::</span><span class="fu">geom_vline</span>(<span class="at">xintercept =</span> primary_weight, <span class="at">col=</span><span class="st">"green4"</span>))</span></code></pre></div>
<div class="figure">
<img src="introduction_files/figure-html/tipmap_plot_refline-1.png" alt="Figure 4: Tipping point plot with reference line." width="95%"><p class="caption">
Figure 4: Tipping point plot with reference line.
</p>
</div>
<p>We see from Figure 4 that, for a weight of 0.38, there is a
probability of larger than 90% but less than 95% based on the posterior
distribution that the treatment effect is larger than 0, i.e.Â the
treatment is efficacious.</p>
</div>
<div class="section level3">
<h3 id="extracting-quantities-of-interest">Extracting quantities of interest<a class="anchor" aria-label="anchor" href="#extracting-quantities-of-interest"></a>
</h3>
<p>The data frame with posteriors for all weights can be filtered to
obtain posterior quantiles for weights of specific interest by the
function <code><a href="../reference/get_posterior_by_weight.html">get_posterior_by_weight()</a></code>:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">get_posterior_by_weight</span>(</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="sc">+</span>   <span class="at">posterior =</span> posterior, </span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="sc">+</span>   <span class="at">weight =</span> <span class="fu">c</span>(primary_weight)</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a><span class="sc">+</span>   )</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a><span class="co">#            q0.01     q0.025      q0.05      q0.1      q0.2    q0.25     q0.5</span></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a><span class="co"># w=0.38 -1.532189 -0.9215547 -0.3613189 0.3085641 0.9449431 1.074658 1.386163</span></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a><span class="co">#           q0.75     q0.8    q0.9    q0.95  q0.975    q0.99</span></span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a><span class="co"># w=0.38 1.636538 1.704554 1.94267 2.348325 2.84356 3.444927</span></span></code></pre></div>
<p>The function <code><a href="../reference/get_tipping_points.html">get_tipping_points()</a></code> extracts tipping
points for one-sided 80%, 90%, 95% and 97.5% evidence levels,
respectively.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="sc">&gt;</span> tipp_points <span class="ot">&lt;-</span> <span class="fu">get_tipping_points</span>(</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a><span class="sc">+</span>   <span class="at">tipmap_data =</span> tipmap_data,  </span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a><span class="sc">+</span>   <span class="at">quantile =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.1</span>, <span class="fl">0.05</span>, <span class="fl">0.025</span>)</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a><span class="sc">+</span> )</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a><span class="sc">&gt;</span> tipp_points</span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a><span class="co">#   q0.2   q0.1  q0.05 q0.025 </span></span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a><span class="co">#  0.050  0.275  0.510  0.710</span></span></code></pre></div>
<p>Calculating the precise posterior probability that treatment effect
exceeds a threshold value is possible via functions in the
<strong>RBesT</strong>-package.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="sc">&gt;</span> prior_primary <span class="ot">&lt;-</span> RBesT<span class="sc">::</span><span class="fu">robustify</span>(</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a><span class="sc">+</span>   <span class="at">priormix =</span> map_prior,</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a><span class="sc">+</span>   <span class="at">weight =</span> (<span class="dv">1</span> <span class="sc">-</span> primary_weight),</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a><span class="sc">+</span>   <span class="at">m =</span> <span class="dv">0</span>,</span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a><span class="sc">+</span>   <span class="at">n =</span> <span class="dv">1</span>,</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a><span class="sc">+</span>   <span class="at">sigma =</span> uisd</span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a><span class="sc">+</span>   )</span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="sc">&gt;</span> posterior_primary <span class="ot">&lt;-</span> RBesT<span class="sc">::</span><span class="fu">postmix</span>(</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a><span class="sc">+</span>   <span class="at">priormix =</span> prior_primary,</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a><span class="sc">+</span>   <span class="at">m =</span> pediatric_trial[<span class="st">"mean"</span>],</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a><span class="sc">+</span>   <span class="at">se =</span> pediatric_trial[<span class="st">"se"</span>]</span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a><span class="sc">+</span>   )</span></code></pre></div>
<p>The posterior probability that the treatment effect is larger than 0,
0.5 and 1, respectively, can be assessed through the cumulative
distribution function of the posterior.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">round</span>(<span class="dv">1</span> <span class="sc">-</span> RBesT<span class="sc">::</span><span class="fu">pmix</span>(posterior_primary, <span class="at">q =</span> <span class="dv">0</span>), <span class="dv">3</span>)</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a><span class="co"># [1] 0.927</span></span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">round</span>(<span class="dv">1</span> <span class="sc">-</span> RBesT<span class="sc">::</span><span class="fu">pmix</span>(posterior_primary, <span class="at">q =</span> <span class="fl">0.5</span>), <span class="dv">3</span>)</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a><span class="co"># [1] 0.879</span></span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">round</span>(<span class="dv">1</span> <span class="sc">-</span> RBesT<span class="sc">::</span><span class="fu">pmix</span>(posterior_primary, <span class="at">q =</span> <span class="dv">1</span>), <span class="dv">3</span>)</span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a><span class="co"># [1] 0.782</span></span></code></pre></div>
<p>This is illustrated by a cumulative density curve of the
posterior.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">library</span>(ggplot2)</span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">plot</span>(posterior_primary, <span class="at">fun =</span> RBesT<span class="sc">::</span>pmix) <span class="sc">+</span></span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">2</span>, <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.927</span>, <span class="fl">0.879</span>, <span class="fl">0.782</span>, <span class="fl">0.5</span>, <span class="dv">0</span>),</span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a><span class="sc">+</span>                      <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a><span class="sc">+</span>                      <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a><span class="sc">+</span>                      ) <span class="sc">+</span></span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">ylab</span>(<span class="st">"Cumulative density of posterior with w=0.38"</span>) <span class="sc">+</span></span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">xlab</span>(<span class="st">"Quantile"</span>) <span class="sc">+</span></span>
<span id="cb23-10"><a href="#cb23-10" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>,</span>
<span id="cb23-11"><a href="#cb23-11" tabindex="-1"></a><span class="sc">+</span>                    <span class="at">y =</span> RBesT<span class="sc">::</span><span class="fu">pmix</span>(<span class="at">mix =</span> posterior_primary, <span class="at">q =</span> <span class="dv">0</span>), </span>
<span id="cb23-12"><a href="#cb23-12" tabindex="-1"></a><span class="sc">+</span>                    <span class="at">xend =</span> <span class="dv">0</span>, </span>
<span id="cb23-13"><a href="#cb23-13" tabindex="-1"></a><span class="sc">+</span>                    <span class="at">yend =</span> <span class="dv">1</span>), </span>
<span id="cb23-14"><a href="#cb23-14" tabindex="-1"></a><span class="sc">+</span>                <span class="at">col=</span><span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb23-15"><a href="#cb23-15" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">0.5</span>,</span>
<span id="cb23-16"><a href="#cb23-16" tabindex="-1"></a><span class="sc">+</span>                    <span class="at">y =</span> RBesT<span class="sc">::</span><span class="fu">pmix</span>(<span class="at">mix =</span> posterior_primary, <span class="at">q =</span> <span class="fl">0.5</span>), </span>
<span id="cb23-17"><a href="#cb23-17" tabindex="-1"></a><span class="sc">+</span>                    <span class="at">xend =</span> <span class="fl">0.5</span>, </span>
<span id="cb23-18"><a href="#cb23-18" tabindex="-1"></a><span class="sc">+</span>                    <span class="at">yend =</span> <span class="dv">1</span>), </span>
<span id="cb23-19"><a href="#cb23-19" tabindex="-1"></a><span class="sc">+</span>                <span class="at">col=</span><span class="st">"red"</span>) <span class="sc">+</span> </span>
<span id="cb23-20"><a href="#cb23-20" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span>,</span>
<span id="cb23-21"><a href="#cb23-21" tabindex="-1"></a><span class="sc">+</span>                    <span class="at">y =</span> RBesT<span class="sc">::</span><span class="fu">pmix</span>(<span class="at">mix =</span> posterior_primary, <span class="at">q =</span> <span class="dv">1</span>), </span>
<span id="cb23-22"><a href="#cb23-22" tabindex="-1"></a><span class="sc">+</span>                    <span class="at">xend =</span> <span class="dv">1</span>, </span>
<span id="cb23-23"><a href="#cb23-23" tabindex="-1"></a><span class="sc">+</span>                    <span class="at">yend =</span> <span class="dv">1</span>), </span>
<span id="cb23-24"><a href="#cb23-24" tabindex="-1"></a><span class="sc">+</span>                <span class="at">col=</span><span class="st">"red"</span>) <span class="sc">+</span> </span>
<span id="cb23-25"><a href="#cb23-25" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">theme_bw</span>()</span></code></pre></div>
<div class="figure">
<img src="introduction_files/figure-html/cumulative_dens-1.png" alt="Figure 5: Cumulative density of posterior with weight w=0.38." width="80%"><p class="caption">
Figure 5: Cumulative density of posterior with weight w=0.38.
</p>
</div>
<p>As a further example, for the weight corresponding to the tipping
point of the one-sided evidence-level of 95% (=0.51), we would obtain a
posterior probability of 95% that the treatment effect is larger than
0.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="sc">&gt;</span> tipp_points[<span class="dv">3</span>]</span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a><span class="co"># q0.05 </span></span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a><span class="co">#  0.51</span></span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="sc">&gt;</span> prior_95p <span class="ot">&lt;-</span> RBesT<span class="sc">::</span><span class="fu">robustify</span>(</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a><span class="sc">+</span>   <span class="at">priormix =</span> map_prior,</span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a><span class="sc">+</span>   <span class="at">weight =</span> (<span class="dv">1</span> <span class="sc">-</span> tipp_points[<span class="dv">3</span>]),</span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a><span class="sc">+</span>   <span class="at">m =</span> <span class="dv">0</span>,</span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a><span class="sc">+</span>   <span class="at">n =</span> <span class="dv">1</span>,</span>
<span id="cb25-6"><a href="#cb25-6" tabindex="-1"></a><span class="sc">+</span>   <span class="at">sigma =</span> uisd</span>
<span id="cb25-7"><a href="#cb25-7" tabindex="-1"></a><span class="sc">+</span>   )</span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="sc">&gt;</span> posterior_95p <span class="ot">&lt;-</span> RBesT<span class="sc">::</span><span class="fu">postmix</span>(</span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a><span class="sc">+</span>   <span class="at">priormix =</span> prior_95p,</span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a><span class="sc">+</span>   <span class="at">m =</span> pediatric_trial[<span class="st">"mean"</span>],</span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a><span class="sc">+</span>   <span class="at">se =</span> pediatric_trial[<span class="st">"se"</span>]</span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a><span class="sc">+</span>   )</span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">round</span>(<span class="dv">1</span> <span class="sc">-</span> RBesT<span class="sc">::</span><span class="fu">pmix</span>(posterior_95p, <span class="at">q =</span> <span class="dv">0</span>), <span class="dv">3</span>)</span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a><span class="co"># [1] 0.95</span></span></code></pre></div>
</div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Best2021" class="csl-entry">
Best, N., Price, R. G., Pouliquen, I. J., et al. (2021) <span class="nocase"><span>A</span>ssessing efficacy in important subgroups in
confirmatory trials: <span>A</span>n example using <span>B</span>ayesian
dynamic borrowing</span>. <em>Pharm Stat</em>, <strong>20</strong>,
551â€“562. DOI: <a href="https://doi.org/10.1002/pst.2093" class="external-link">10.1002/pst.2093</a>.
</div>
<div id="ref-Gamalo2022" class="csl-entry">
Gamalo, M., Bucci-Rechtweg, C., Nelson, R. M., et al. (2022) <span class="nocase"><span>E</span>xtrapolation as a <span>D</span>efault
<span>S</span>trategy in <span>P</span>ediatric <span>D</span>rug
<span>D</span>evelopment</span>. <em>Ther Innov Regul Sci</em>,
<strong>56</strong>, 883â€“894. DOI: <a href="https://doi.org/10.1007/s43441-021-00367-9" class="external-link">10.1007/s43441-021-00367-9</a>.
</div>
<div id="ref-Held2022" class="csl-entry">
Held, L., Matthews, R., Ott, M., et al. (2022) <span class="nocase"><span>R</span>everse-<span>B</span>ayes methods for
evidence assessment and research synthesis</span>. <em>Res Synth
Methods</em>, <strong>13</strong>, 295â€“314. DOI: <a href="https://doi.org/10.1002/jrsm.1538" class="external-link">10.1002/jrsm.1538</a>.
</div>
<div id="ref-ICHE11A" class="csl-entry">
ICH (2022) <span class="nocase"><span>I</span>nternational
<span>C</span>ouncil for <span>H</span>armonisation of
<span>T</span>echnical <span>R</span>equirements for
<span>P</span>harmaceuticals for <span>H</span>uman <span>U</span>se
<span>(ICH)</span></span> guideline <span>E11A</span> on pediatric
extrapolation. <span>EMA/CHMP/ICH/205218/2022</span>. <span>URL:</span>
<a href="https://www.ema.europa.eu/en/ich-guideline-e11a-pediatric-extrapolation-scientific-guideline" class="external-link uri">https://www.ema.europa.eu/en/ich-guideline-e11a-pediatric-extrapolation-scientific-guideline</a>.
</div>
<div id="ref-Ionan2023" class="csl-entry">
Ionan, A. C., Clark, J., Travis, J., et al. (2023) <span class="nocase"><span>B</span>ayesian <span>M</span>ethods in
<span>H</span>uman <span>D</span>rug and <span>B</span>iological
<span>P</span>roducts <span>D</span>evelopment in
<span>C</span><span>D</span><span>E</span><span>R</span> and
<span>C</span><span>B</span><span>E</span><span>R</span></span>.
<em>Ther Innov Regul Sci</em>, <strong>57</strong>, 436â€“444. DOI: <a href="https://doi.org/10.1007/s43441-022-00483-0" class="external-link">10.1007/s43441-022-00483-0</a>.
</div>
<div id="ref-Maher2024" class="csl-entry">
Maher, T. M., Brown, K. K., Cunningham, S., et al. (2024) <span class="nocase"><span>E</span>stimating the effect of nintedanib on
forced vital capacity in children and adolescents with fibrosing
interstitial lung disease using a <span>B</span>ayesian dynamic
borrowing approach</span>. <em>Pediatr Pulmonol</em>, in press.
</div>
<div id="ref-Neuenschwander2020" class="csl-entry">
Neuenschwander, B. and Schmidli, H. (2020) <span>U</span>se of
<span>H</span>istorical <span>D</span>ata. In <em><span>B</span>ayesian
<span>M</span>ethods in <span>P</span>harmaceutical
<span>R</span>esearch</em> (eds E. Lesaffre, G. Baio, and B. Boulanger),
pp. 111â€“129. 1st ed. Chapman &amp; Hall/ CRC Biostatistics Series. DOI:
<a href="https://doi.org/10.1201/9781315180212" class="external-link">https://doi.org/10.1201/9781315180212</a>.
</div>
<div id="ref-Schmidli2014" class="csl-entry">
Schmidli, H., Gsteiger, S., Roychoudhury, S., et al. (2014) <span class="nocase"><span>R</span>obust meta-analytic-predictive priors in
clinical trials with historical control information</span>.
<em>Biometrics</em>, <strong>70</strong>, 1023â€“1032. DOI: <a href="https://doi.org/10.1111/biom.12242" class="external-link">10.1111/biom.12242</a>.
</div>
<div id="ref-Travis2023" class="csl-entry">
Travis, J., Rothmann, M. and Thomson, A. (2023) <span class="nocase"><span>P</span>erspectives on informative
<span>B</span>ayesian methods in pediatrics</span>. <em>J Biopharm
Stat</em>, to appear. DOI: <a href="https://doi.org/10.1080/10543406.2023.2170405" class="external-link">10.1080/10543406.2023.2170405</a>.
</div>
<div id="ref-Weber2021" class="csl-entry">
Weber, S., Li, Y., Seaman III, J. W., et al. (2021)
<span>A</span>pplying
<span>M</span>eta-<span>A</span>nalytic-<span>P</span>redictive
<span>P</span>riors with the <span>R</span> <span>B</span>ayesian
<span>E</span>vidence <span>S</span>ynthesis <span>T</span>ools. <em>J
Stat Softw</em>, <strong>100</strong>, 1â€“32. DOI: <a href="https://doi.org/10.18637/jss.v100.i19" class="external-link">10.18637/jss.v100.i19</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Christian Stock, Morten Dreher, Boehringer Ingelheim Pharma GmbH &amp; Co.Â KG.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
