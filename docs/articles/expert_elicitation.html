<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="tipmap">
<title>Specifying a primary weight of the informative prior component • tipmap</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Specifying a primary weight of the informative prior component">
<meta property="og:description" content="tipmap">
<meta property="og:image" content="https://boehringer-ingelheim.github.io/tipmap/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">tipmap</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/expert_elicitation.html">Specifying a primary weight of the informative prior component</a>
    <a class="dropdown-item" href="../articles/introduction.html">Introduction to the 'tipmap' package</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/Boehringer-Ingelheim/tipmap/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Specifying a primary weight of the informative prior component</h1>
                        <h4 data-toc-skip class="author">Christian
Stock</h4>
            
            <h4 data-toc-skip class="date">2024-04-04</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/Boehringer-Ingelheim/tipmap/blob/HEAD/vignettes/expert_elicitation.Rmd" class="external-link"><code>vignettes/expert_elicitation.Rmd</code></a></small>
      <div class="d-none name"><code>expert_elicitation.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>In a clinical trial project that uses Bayesian dynamic borrowing via
meta-analytic predictive (MAP) priors, ideally a pre-specified weight of
the informative component of the MAP prior needs to be determined (<span class="citation">Ionan <em>et al.</em> (2023)</span>). Expert
elicitation is a way through which expert judgement can be formally
considered for statistical inference and decision making and it can be
used to determine this weight.</p>
<p>For reviews on expert elicitaton see e.g. <span class="citation">Brownstein <em>et al.</em> (2019)</span> and <span class="citation">O’Hagan (2019)</span>, and for experiences with expert
elicitation in drug development see e.g. <span class="citation">Dallow
<em>et al.</em> (2018)</span>.</p>
<p>The Sheffield elicitation framework (SHELF) is an established
framework that is used for the conduct of expert elicitation (<span class="citation">O’Hagan (2019)</span>, <span class="citation">Gosling
(2018)</span>, <span class="citation">Best <em>et al.</em>
(2020)</span>), and the SHELF package is available to facilitate
implementation in R (<span class="citation">The Sheffield Elicitation
Framework (2019)</span>).</p>
<p>This vignette provides a brief description of how expert elicitation
can be used in a Bayesian borrowing analysis using robust MAP priors. It
is not a description of the expert elicitation process, it shows how
elicited data can be processed. It is based on and closely resembles
functions in the SHELF package, but is much more limited, in the sense
that it only considered determination of one weight parameter (a
variable on the scale [0,1]).</p>
<p>The data in this example are hypothetical data.</p>
<p>Loading the <code>tipmap</code> package and
<code>set.seed</code>:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">library</span>(tipmap)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">set.seed</span>(<span class="dv">123</span>)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="expert-weightings-collected-using-the-roulette-method">Expert weightings collected using the roulette method<a class="anchor" aria-label="anchor" href="#expert-weightings-collected-using-the-roulette-method"></a>
</h2>
<p>Here, the expert data are assumed to be collected via the ‘roulette
method’ (<span class="citation">Gosling (2018)</span>, <span class="citation">Dallow <em>et al.</em> (2018)</span>). The experts are
asked to place 10 chips into a grid to create histogram-like data that
reflects their preferred weighting. No particular shape of symmetry is
needed.</p>
<p>Data from a single expert:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="sc">&gt;</span> chips_1exp <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">sum</span>(chips_1exp)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="co"># [1] 10</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="fitting-beta-distributions-to-expert-data">Fitting beta distributions to expert data<a class="anchor" aria-label="anchor" href="#fitting-beta-distributions-to-expert-data"></a>
</h2>
<p>The roulette data are assumed to follow a beta distribution. The
following calculation and fitting of a beta distribution is similar to
an implementation in <code>SHELF::fitdist</code> and yields identical
results.</p>
<p>Data from a single expert:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># Compute cumulative probabilities</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="er">&gt;</span> (x <span class="ot">&lt;-</span> <span class="fu">get_cum_probs_1exp</span>(chips_1exp))</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co">#  [1] 0.1 0.4 0.8 1.0 1.0 1.0 1.0 1.0 1.0 1.0</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># Compute model inputs</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="er">&gt;</span> (y <span class="ot">&lt;-</span> <span class="fu">get_model_input_1exp</span>(x))</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co">#     w cum_probs</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co"># 1 0.1       0.1</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="co"># 2 0.2       0.4</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="co"># 3 0.3       0.8</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="co"># 4 0.4       1.0</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># Fit beta distribution</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="er">&gt;</span> (fit_1exp <span class="ot">&lt;-</span> <span class="fu">fit_beta_1exp</span>(<span class="at">df =</span> y)<span class="sc">$</span>par)</span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a><span class="co">#     alpha      beta </span></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a><span class="co">#  4.195173 14.182162</span></span></code></pre></div>
<p>For multiple experts the individual steps are handled by the
<code>fit_beta_mult_exp</code>-function:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="sc">&gt;</span> chips_mult <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="sc">+</span> )</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="sc">&gt;</span> beta_fits <span class="ot">&lt;-</span> <span class="fu">fit_beta_mult_exp</span>(</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="sc">+</span>   <span class="at">chips_mult =</span> chips_mult</span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="sc">+</span> )</span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="sc">&gt;</span> beta_fits</span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="co">#  [38;5;246m# A tibble: 5 × 4 [39m</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="co">#   alpha  beta    error convergence</span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="co">#    [3m [38;5;246m&lt;dbl&gt; [39m [23m  [3m [38;5;246m&lt;dbl&gt; [39m [23m     [3m [38;5;246m&lt;dbl&gt; [39m [23m  [3m [38;5;246m&lt;lgl&gt; [39m [23m      </span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a><span class="co">#  [38;5;250m1 [39m  4.20 14.2  0.001 [4m7 [24m [4m9 [24m  TRUE       </span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a><span class="co">#  [38;5;250m2 [39m  3.29  6.97 0.001 [4m3 [24m [4m6 [24m  TRUE       </span></span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a><span class="co">#  [38;5;250m3 [39m  3.30  5.70 0.003 [4m9 [24m [4m9 [24m  TRUE       </span></span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a><span class="co">#  [38;5;250m4 [39m  2.99  9.25 0.000 [4m1 [24m [4m0 [24m [4m6 [24m TRUE       </span></span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a><span class="co">#  [38;5;250m5 [39m  6.90 15.3  0.001 [4m3 [24m [4m6 [24m  TRUE</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="summary-statistics">Summary statistics<a class="anchor" aria-label="anchor" href="#summary-statistics"></a>
</h2>
<p>Summary statistics for a single expert:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="sc">&gt;</span> (alpha <span class="ot">&lt;-</span> fit_1exp[<span class="dv">1</span>]); (beta <span class="ot">&lt;-</span> fit_1exp[<span class="dv">2</span>])</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="co">#    alpha </span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co"># 4.195173</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co">#     beta </span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="co"># 14.18216</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="er">&gt;</span> <span class="co"># Mean</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="er">&gt;</span> (beta_mean <span class="ot">&lt;-</span> alpha<span class="sc">/</span>(alpha<span class="sc">+</span>beta))</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="co">#     alpha </span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="co"># 0.2282797</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="er">&gt;</span> <span class="co"># Standard deviation</span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="er">&gt;</span> beta_sd <span class="ot">&lt;-</span> <span class="fu">sqrt</span>( (alpha<span class="sc">*</span>beta)<span class="sc">/</span>( (alpha<span class="sc">+</span>beta)<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span>(alpha<span class="sc">+</span>beta<span class="sc">+</span><span class="dv">1</span>) ) )</span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="sc">&gt;</span> beta_sd</span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a><span class="co">#     alpha </span></span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a><span class="co"># 0.0953491</span></span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a><span class="er">&gt;</span> <span class="co"># Mean absolute deviation around the mean</span></span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a><span class="er">&gt;</span> beta_mad_mean <span class="ot">&lt;-</span> (<span class="dv">2</span><span class="sc">*</span>(alpha<span class="sc">^</span>alpha)<span class="sc">*</span>(beta<span class="sc">^</span>beta))<span class="sc">/</span>( <span class="fu">beta</span>(alpha, beta) <span class="sc">*</span> (alpha<span class="sc">+</span>beta)<span class="sc">^</span>(alpha<span class="sc">+</span>beta<span class="sc">+</span><span class="dv">1</span>) )</span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a><span class="sc">&gt;</span> beta_mad_mean</span>
<span id="cb5-21"><a href="#cb5-21" tabindex="-1"></a><span class="co">#      alpha </span></span>
<span id="cb5-22"><a href="#cb5-22" tabindex="-1"></a><span class="co"># 0.07648378</span></span>
<span id="cb5-23"><a href="#cb5-23" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb5-24"><a href="#cb5-24" tabindex="-1"></a><span class="er">&gt;</span> <span class="co"># Mode</span></span>
<span id="cb5-25"><a href="#cb5-25" tabindex="-1"></a><span class="er">&gt;</span> <span class="cf">if</span> (alpha <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;</span> beta <span class="sc">&gt;</span><span class="dv">1</span>) beta_mode <span class="ot">&lt;-</span> (alpha<span class="dv">-1</span>)<span class="sc">/</span>(alpha<span class="sc">+</span>beta<span class="dv">-2</span>)</span>
<span id="cb5-26"><a href="#cb5-26" tabindex="-1"></a><span class="sc">&gt;</span> <span class="cf">if</span> (alpha <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;</span> beta <span class="sc">&gt;</span><span class="dv">1</span>) beta_mode <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb5-27"><a href="#cb5-27" tabindex="-1"></a><span class="sc">&gt;</span> beta_mode</span>
<span id="cb5-28"><a href="#cb5-28" tabindex="-1"></a><span class="co"># [1] 0.5</span></span>
<span id="cb5-29"><a href="#cb5-29" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb5-30"><a href="#cb5-30" tabindex="-1"></a><span class="er">&gt;</span> <span class="co"># Quantiles</span></span>
<span id="cb5-31"><a href="#cb5-31" tabindex="-1"></a><span class="er">&gt;</span> <span class="fu">qbeta</span>(<span class="at">p =</span> <span class="fu">c</span>(<span class="fl">0.001</span>, <span class="fl">0.025</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">0.9</span>, <span class="fl">0.95</span>, <span class="fl">0.975</span>, <span class="fl">0.99</span>),</span>
<span id="cb5-32"><a href="#cb5-32" tabindex="-1"></a><span class="sc">+</span>       <span class="at">shape1 =</span> alpha, <span class="at">shape2 =</span> beta)</span>
<span id="cb5-33"><a href="#cb5-33" tabindex="-1"></a><span class="co"># [1] 0.03030170 0.07286831 0.08986138 0.11249422 0.21827787 0.35769286 0.40104115</span></span>
<span id="cb5-34"><a href="#cb5-34" tabindex="-1"></a><span class="co"># [8] 0.43928844 0.48403929</span></span>
<span id="cb5-35"><a href="#cb5-35" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb5-36"><a href="#cb5-36" tabindex="-1"></a><span class="er">&gt;</span> <span class="co"># Samples</span></span>
<span id="cb5-37"><a href="#cb5-37" tabindex="-1"></a><span class="er">&gt;</span> x <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="at">n =</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>, <span class="at">shape1 =</span> alpha, <span class="at">shape2 =</span> beta)</span>
<span id="cb5-38"><a href="#cb5-38" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">mean</span>(x)</span>
<span id="cb5-39"><a href="#cb5-39" tabindex="-1"></a><span class="co"># [1] 0.228191</span></span>
<span id="cb5-40"><a href="#cb5-40" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">sd</span>(x)</span>
<span id="cb5-41"><a href="#cb5-41" tabindex="-1"></a><span class="co"># [1] 0.09536257</span></span></code></pre></div>
<p>Summary statistics for data from multiple experts:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="sc">&gt;</span> expert_samples <span class="ot">&lt;-</span> <span class="fu">draw_beta_mixture_nsamples</span>(</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="sc">+</span>   <span class="at">n =</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">3</span>, </span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="sc">+</span>   <span class="at">chips_mult =</span> chips_mult</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="sc">+</span> ) </span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">summary</span>(expert_samples)</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="co">#    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="co"># 0.03643 0.19375 0.27175 0.28619 0.35947 0.75872</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="sc">&gt;</span> (mean_w <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">mean</span>(expert_samples), <span class="dv">2</span>))</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="co"># [1] 0.29</span></span></code></pre></div>
<p>Mean or median values of the pooled distribution may be used as
primary weights of the informative component of the robust MAP prior
when pre-specifying the Bayesian analysis.</p>
</div>
<div class="section level2">
<h2 id="figures">Figures<a class="anchor" aria-label="anchor" href="#figures"></a>
</h2>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># Load libraries</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="er">&gt;</span> packages <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"magrittr"</span>, <span class="st">"ggplot2"</span>, <span class="st">"tibble"</span>, <span class="st">"dplyr"</span>)</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">invisible</span>(<span class="fu">lapply</span>(packages, library, <span class="at">character.only =</span> T))</span></code></pre></div>
<div class="section level3">
<h3 id="without-linear-pooling">Without linear pooling<a class="anchor" aria-label="anchor" href="#without-linear-pooling"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># Create matrix</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="er">&gt;</span> fits_mat <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(beta_fits[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)])</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># Wide format</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="er">&gt;</span> fit_beta_mult_plot_wide <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="sc">+</span>  <span class="at">x =</span> <span class="fu">seq</span>(<span class="fl">0.001</span>, <span class="fl">0.999</span>, <span class="at">length =</span> <span class="dv">200</span>),</span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="sc">+</span>  <span class="at">Expert1 =</span> <span class="fu">dbeta</span>(x, fits_mat[<span class="dv">1</span>,<span class="dv">1</span>], fits_mat[<span class="dv">1</span>,<span class="dv">2</span>]),</span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="sc">+</span>  <span class="at">Expert2 =</span> <span class="fu">dbeta</span>(x, fits_mat[<span class="dv">2</span>,<span class="dv">1</span>], fits_mat[<span class="dv">2</span>,<span class="dv">2</span>]),</span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="sc">+</span>  <span class="at">Expert3 =</span> <span class="fu">dbeta</span>(x, fits_mat[<span class="dv">3</span>,<span class="dv">1</span>], fits_mat[<span class="dv">3</span>,<span class="dv">2</span>]),</span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="sc">+</span>  <span class="at">Expert4 =</span> <span class="fu">dbeta</span>(x, fits_mat[<span class="dv">4</span>,<span class="dv">1</span>], fits_mat[<span class="dv">4</span>,<span class="dv">2</span>]),</span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a><span class="sc">+</span>  <span class="at">Expert5 =</span> <span class="fu">dbeta</span>(x, fits_mat[<span class="dv">5</span>,<span class="dv">1</span>], fits_mat[<span class="dv">5</span>,<span class="dv">2</span>])</span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="sc">+</span> )</span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># Long format</span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a><span class="er">&gt;</span> fit_beta_mult_plot_long <span class="ot">&lt;-</span> fit_beta_mult_plot_wide <span class="sc">%&gt;%</span></span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a><span class="sc">+</span>   tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(</span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a><span class="sc">+</span>     <span class="sc">!</span>x,</span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a><span class="sc">+</span>     <span class="at">names_to =</span> <span class="st">"Expert"</span>,</span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a><span class="sc">+</span>     <span class="at">values_to =</span> <span class="st">"dens"</span>)</span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># Plot without linear pool</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="er">&gt;</span> fig_betas_1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="sc">+</span>   <span class="at">data =</span> fit_beta_mult_plot_long,</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> dens, <span class="at">goup =</span> Expert)</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a><span class="sc">+</span>   ) <span class="sc">+</span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> Expert)) <span class="sc">+</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a><span class="sc">+</span>  <span class="fu">ggtitle</span>(<span class="st">"Fitted beta distributions"</span>) <span class="sc">+</span></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a><span class="sc">+</span>  <span class="fu">xlab</span>(<span class="st">"Weight"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Density"</span>) <span class="sc">+</span></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a><span class="sc">+</span>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>) <span class="sc">/</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a><span class="sc">+</span>  <span class="fu">theme_bw</span>()</span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">print</span>(fig_betas_1)</span></code></pre></div>
<p><img src="expert_elicitation_files/figure-html/elicitfig1b-1.png" width="95%"></p>
</div>
<div class="section level3">
<h3 id="with-linear-pooling">With linear pooling<a class="anchor" aria-label="anchor" href="#with-linear-pooling"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># Wide format</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="er">&gt;</span> fit_beta_mult_plot_wide2 <span class="ot">&lt;-</span> fit_beta_mult_plot_wide <span class="sc">%&gt;%</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">mutate</span>(<span class="at">linpool =</span> (Expert1 <span class="sc">+</span> Expert2 <span class="sc">+</span> Expert3 <span class="sc">+</span> Expert4 <span class="sc">+</span> Expert5)<span class="sc">/</span><span class="dv">5</span>)</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># Long format</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="er">&gt;</span> fit_beta_mult_plot_long2 <span class="ot">&lt;-</span> fit_beta_mult_plot_wide <span class="sc">%&gt;%</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="sc">+</span>   tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="sc">+</span>     <span class="sc">!</span>x,</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="sc">+</span>     <span class="at">names_to =</span> <span class="st">"Expert"</span>,</span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="sc">+</span>     <span class="at">values_to =</span> <span class="st">"dens"</span>)</span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># Plot</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="er">&gt;</span> fig_betas_2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="sc">+</span>   <span class="at">data =</span> fit_beta_mult_plot_long2,</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> dens, <span class="at">group =</span> Expert)) <span class="sc">+</span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> Expert ) ) <span class="sc">+</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">ggtitle</span>(<span class="st">"Fitted beta distributions and linear pool"</span>) <span class="sc">+</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">xlab</span>(<span class="st">"Weight"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Density"</span>) <span class="sc">+</span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>)<span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">geom_line</span>(<span class="at">data =</span> fit_beta_mult_plot_wide2,</span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a><span class="sc">+</span>             <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> linpool, <span class="at">group =</span> <span class="dv">1</span>),</span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a><span class="sc">+</span>             <span class="at">linewidth=</span><span class="dv">1</span>)</span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">print</span>(fig_betas_2)</span></code></pre></div>
<p><img src="expert_elicitation_files/figure-html/elicitfig2b-1.png" width="95%"></p>
</div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Best2020" class="csl-entry">
Best, N., Dallow, N. and Montague, T. (2020) <span class="nocase">Prior
Elicitation. In: Lesaffre E, Baio G, Boulanger B (editors). Bayesian
Methods in Pharmaceutical Research. CRC Press</span>.
</div>
<div id="ref-Brownstein2019" class="csl-entry">
Brownstein, N. C., Louis, T. A., O’Hagan, A., et al. (2019) The role of
expert judgment in statistical inference and evidence-based
decision-making. <em>Am Stat</em>, <strong>73</strong>, 56–68.
</div>
<div id="ref-Dallow2018" class="csl-entry">
Dallow, N., Best, N. and Montague, T. H. (2018) <span class="nocase"><span>B</span>etter decision making in drug development
through adoption of formal prior elicitation</span>. <em>Pharm
Stat</em>, <strong>17</strong>, 301–316.
</div>
<div id="ref-Gosling2018" class="csl-entry">
Gosling, J. P. (2018) <span>SHELF</span>: <span>T</span>he
<span>S</span>heffield <span>E</span>licitation <span>F</span>ramework.
In <em>Elicitation: The Science and Art of Structuring Judgement</em>
(eds L. C. Dias, A. Morton, and J. Quigley), pp. 61–93. Springer
International Publishing.
</div>
<div id="ref-Ionan2023" class="csl-entry">
Ionan, A. C., Clark, J., Travis, J., et al. (2023) <span class="nocase"><span>B</span>ayesian <span>M</span>ethods in
<span>H</span>uman <span>D</span>rug and <span>B</span>iological
<span>P</span>roducts <span>D</span>evelopment in
<span>C</span><span>D</span><span>E</span><span>R</span> and
<span>C</span><span>B</span><span>E</span><span>R</span></span>.
<em>Ther Innov Regul Sci</em>, <strong>57</strong>, 436–444. DOI: <a href="https://doi.org/10.1007/s43441-022-00483-0" class="external-link">10.1007/s43441-022-00483-0</a>.
</div>
<div id="ref-OHagan2019" class="csl-entry">
O’Hagan, A. (2019) <span>E</span>xpert <span>K</span>nowledge
<span>E</span>licitation: <span>S</span>ubjective but
<span>S</span>cientific. <em>Am Stat</em>, <strong>73</strong>, 69–81.
Taylor &amp; Francis.
</div>
<div id="ref-SHELFv4" class="csl-entry">
The Sheffield Elicitation Framework (2019) <span>URL:</span> <a href="http://www.tonyohagan.co.uk/shelf/SHELF4.html" class="external-link uri">Http://www.tonyohagan.co.uk/shelf/SHELF4.html</a>, version
4.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Christian Stock, Morten Dreher, Boehringer Ingelheim Pharma GmbH &amp; Co. KG.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
